<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Smooothy-like • Sentidos</title>
<style>
  :root{
    --bg:#0b0b0d;
    --ink:#eaeaea;
    --muted:#8a8a8f;
    --card-w: 36vw;
    --card-h: 58vh;
    --gap: 6vw;               /* espacio entre tarjetas */
    --bullet: #6f6f76;
    --bullet-active:#ffffff;
    --rad: 28px;
  }

  *{ box-sizing:border-box; -webkit-tap-highlight-color:transparent }
  html,body{ height:100% }
  body{
    margin:0; color:var(--ink); background:var(--bg);
    font: 500 14px/1.35 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;
    overflow:hidden; /* canvas fijo */
  }

  /* ========== Header ========== */
  .topbar{
    position:fixed; inset:0 0 auto 0; height:72px; display:flex; align-items:center;
    padding:0 22px; gap:22px; z-index:40; pointer-events:none;
  }
  .brand{
    font-weight:900; letter-spacing:.08em; font-size:20px; pointer-events:auto;
  }
  .help{ color:var(--muted); max-width:520px; pointer-events:auto }
  .sep{ flex:1 }

  /* ========== Stage ========== */
  .stage{
    position:fixed; inset:0; display:grid; place-items:center; overflow:hidden;
  }
  .rail{
    position:relative; height:var(--card-h);
    /* ancho virtual = N*(card + gap) => lo controlamos por transform */
    will-change:transform;
  }

  /* ========== Card ========== */
  .card{
    position:absolute; top:50%; transform:translate3d(0,-50%,0);
    width:var(--card-w); height:var(--card-h);
    border-radius: var(--rad);
    overflow:hidden;
    box-shadow: 0 40px 80px rgba(0,0,0,.35);
    cursor: grab;
    user-select:none;
    transition: filter .25s ease;
  }
  .card:active{ cursor:grabbing }
  .panel{
    position:absolute; inset:0;
    /* 3 capas: fg, mid, degradado */
    --fg-size: min(56%, 520px);
    --mid-size: min(92%, 860px);
    background:
      var(--fg) center / var(--fg-size) no-repeat,
      var(--mid) center / var(--mid-size) no-repeat,
      radial-gradient(120% 120% at 50% 50%, rgba(255,255,255,.08) 0%, rgba(0,0,0,.25) 70%);
    border-radius:inherit;
  }
  .label{
    position:absolute; inset:auto auto 20px 20px;
    background:rgba(255,255,255,.08); backdrop-filter: blur(6px);
    padding:6px 12px; border-radius:14px; font-weight:600;
  }

  /* tilt/parallax sombra suave */
  .card::after{
    content:""; position:absolute; inset:-40px; border-radius:inherit;
    background: radial-gradient(40% 60% at 50% 80%, rgba(0,0,0,.35) 0, transparent 70%);
    mix-blend-mode:overlay; pointer-events:none;
  }

  /* ========== arrows ========== */
  .arrows{ position:fixed; inset:auto 18px 40px auto; display:flex; gap:12px; z-index:20 }
  .btn{
    width:44px; height:44px; display:grid; place-items:center; border-radius:50%;
    background:rgba(255,255,255,.06); color:#fff; border:1px solid rgba(255,255,255,.12);
    cursor:pointer; transition:transform .15s ease, background .2s ease;
  }
  .btn:hover{ transform:scale(1.06); background:rgba(255,255,255,.12) }

  /* ========== bullets ========== */
  .dots{
    position:fixed; inset:auto 0 24px 0; display:flex; gap:10px; justify-content:center; z-index:20;
  }
  .dot{
    width:8px; height:8px; border-radius:50%; background:var(--bullet); opacity:.65;
    transition:transform .2s ease, opacity .2s ease, background .2s ease;
  }
  .dot.is-active{ background:var(--bullet-active); opacity:1; transform:scale(1.35) }

  /* Responsivo */
  @media (max-width: 1024px){
    :root{ --card-w: 64vw; --card-h: 58vh; --gap: 8vw }
    .help{ display:none }
  }
  @media (max-width: 640px){
    :root{ --card-w: 82vw; --card-h: 62vh; --gap: 10vw }
  }
</style>
</head>
<body>

<header class="topbar">
  <div class="brand">SMOOTHY</div>
  <div class="help">Arrastra / usa las flechas → Inercia + loop infinito + parallax sutil (estilo smooothy)</div>
  <div class="sep"></div>
</header>

<main class="stage" id="stage">
  <div class="rail" id="rail"></div>
</main>

<div class="arrows">
  <button class="btn" id="prev" aria-label="Anterior">←</button>
  <button class="btn" id="next" aria-label="Siguiente">→</button>
</div>
<div class="dots" id="dots"></div>

<script>
/* ===========================================================
   Datos de tarjetas (usa tus PNG en /assets)
   Cada ítem: {title, mid, fg, tint}  tint: color de envolvente al pasar
=========================================================== */
const ITEMS = [
  { title:"Visión",     mid:"/assets/vision-mid.png",     fg:"/assets/vision-fg.png",     tint:"#5B7BE1" },
  { title:"Escucha",    mid:"/assets/escucha-mid.png",    fg:"/assets/escucha-fg.png",    tint:"#E15B9C" },
  { title:"Olfato",     mid:"/assets/olfato-mid.png",     fg:"/assets/olfato-fg.png",     tint:"#E06AA0" },
  { title:"Sabor",      mid:"/assets/sabor-mid.png",      fg:"/assets/sabor-fg.png",      tint:"#DE7C7B" },
  { title:"Tacto",      mid:"/assets/tacto-mid.png",      fg:"/assets/tacto-fg.png",      tint:"#C96AE6" },
  { title:"Equilibrio", mid:"/assets/equilibrio-mid.png", fg:"/assets/equilibrio-fg.png", tint:"#E0A23A" },
];

const rail = document.getElementById('rail');
const dots = document.getElementById('dots');

/* Construye DOM de tarjetas */
const cards = ITEMS.map((it, i) => {
  const el = document.createElement('article');
  el.className = 'card';
  // set backgrounds mediante custom props
  el.style.setProperty('--mid', `url('${it.mid}')`);
  el.style.setProperty('--fg',  `url('${it.fg}')`);

  // capa pintora
  const panel = document.createElement('div');
  panel.className = 'panel';
  el.appendChild(panel);

  // etiqueta
  const cap = document.createElement('div');
  cap.className = 'label';
  cap.textContent = it.title;
  el.appendChild(cap);

  rail.appendChild(el);
  return el;
});

/* Bullets */
const dotEls = ITEMS.map((_,i)=>{
  const d=document.createElement('div');
  d.className='dot';
  dots.appendChild(d);
  d.addEventListener('click',()=>snapTo(i));
  return d;
});

/* ---------------- Slider con inercia + loop ---------------- */
let N = ITEMS.length;
let gapPx = 0;       // se calcula en resize
let cardW = 0;

let current = 0;     // posición flotante (0..N)
let target  = 0;     // destino (arrastre / flechas)
let press = false;
let startX = 0;
let vx = 0;          // velocidad (para inercia)
const friction = 0.92;
const lerpK = 0.085;

function wrap(i, n){  // wrap circular 0..n
  i = (i % n + n) % n;
  return i;
}

function layout(){
  const cs = getComputedStyle(document.documentElement);
  const cardH = parseFloat(cs.getPropertyValue('--card-h'));
  gapPx = parseFloat(cs.getPropertyValue('--gap').replace('vw',''))/100 * innerWidth; // aprox
  cardW = parseFloat(cs.getPropertyValue('--card-w').replace('vw',''))/100 * innerWidth;

  rail.style.width = (N*(cardW+gapPx)+innerWidth)+'px'; // grande para no recortar

  cards.forEach((el, i)=>{
    el.style.width  = cardW+'px';
    el.style.height = cardH+'px';
  });
}
layout(); addEventListener('resize', layout);

/* Posicionamiento continuo con wrapping */
function render(){
  // easing hacia target
  const diff = shortestDelta(current, target, N);
  current += diff * lerpK;

  // para cada tarjeta, colocación en línea infinita
  for(let i=0;i<N;i++){
    // posición relativa (i - current) con wrap al rango [-N/2 .. N/2]
    let rel = normalizeRange(i - current, -N/2, N/2);
    const x = rel * (cardW + gapPx);
    const el = cards[i];

    el.style.transform = `translate3d(${(innerWidth/2 - cardW/2) + x}px, -50%, 0)`; // centrada vertical y desplazada

    // Tilt/parallax sutil según distancia al centro:
    const d = Math.min(1, Math.abs(rel));
    el.style.filter = `saturate(${1 - d*0.35}) brightness(${1 - d*0.08})`;
    const tilt = clamp(-rel, -1, 1) * 6; // grados
    el.children[0].style.transform = `translateZ(0) rotate(${tilt}deg)`;
  }

  // inercia post-drag
  if(!press && Math.abs(vx) > .01){
    target += vx;
    vx *= friction;
  }

  // bullets
  const active = Math.round(wrap(current, N));
  dotEls.forEach((d,i)=>d.classList.toggle('is-active', i===wrap(active,N)));

  requestAnimationFrame(render);
}
requestAnimationFrame(render);

/* Helpers de rango cíclico */
function shortestDelta(a,b,n){
  // delta mínimo en anillo [0..n)
  let d = (b - a) % n;
  if(d >  n/2) d -= n;
  if(d < -n/2) d += n;
  return d;
}
function normalizeRange(v, min, max){
  const w = max - min;
  while(v < min) v += w;
  while(v > max) v -= w;
  return v;
}
const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));

/* Arrastre / tacto */
rail.addEventListener('pointerdown', e=>{
  press = true; startX = e.clientX; vx = 0;
  rail.setPointerCapture(e.pointerId);
});
rail.addEventListener('pointermove', e=>{
  if(!press) return;
  const dx = (e.clientX - startX) / (cardW + gapPx);
  startX = e.clientX;
  target -= dx;                 // objetivo corre con el drag
  vx = -dx;                     // velocidad para inercia
});
addEventListener('pointerup', ()=>{
  press = false;
});

/* Rueda horizontal (trackpad/mouse) */
addEventListener('wheel', e=>{
  const dx = (e.deltaY || e.deltaX) / 500; // sensibilidad
  target += dx;
});

/* Flechas */
document.getElementById('prev').onclick = ()=> snapTo(Math.round(target-1));
document.getElementById('next').onclick = ()=> snapTo(Math.round(target+1));

function snapTo(i){
  target = wrap(i, N);
}

/* Inicio centrado en 0 */
target = 0;
</script>
</body>
</html>
